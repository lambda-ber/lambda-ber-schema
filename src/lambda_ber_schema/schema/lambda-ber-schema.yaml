id: https://w3id.org/lambda-ber-schema/
name: lambda-ber-schema
description: |
  lambda-ber-schema is a comprehensive schema for representing multimodal structural biology imaging data, 
  from atomic-resolution structures to tissue-level organization. It supports diverse experimental 
  techniques including cryo-EM, X-ray crystallography, SAXS/SANS, fluorescence microscopy, and 
  spectroscopic imaging.

  ## Schema Organization

  The schema follows a hierarchical structure that mirrors how structural biology research is organized:

  The top-level entity is a [Dataset](Dataset.md), which serves as a container for related research.
  A dataset might represent all data from a specific grant, collaboration, or publication.

  Each dataset contains one or more [Studies](Study.md), which are focused investigations of specific
  biological questions. For example, a study might investigate "Heat stress response in Arabidopsis"
  or "Structure of the human ribosome under different conditions."

  Within each study, you'll find:

  ### Biological Materials
  - [Samples](Sample.md): The biological specimens being studied (proteins, nucleic acids, complexes, 
    cells, tissues). Each sample includes detailed molecular composition, buffer conditions, and 
    storage information. For example, a purified protein with its sequence, concentration, and buffer pH.
  
  - [Sample Preparations](SamplePreparation.md): How samples were prepared for specific techniques.
    This includes cryo-EM grid preparation (vitrification parameters), crystallization conditions for
    X-ray studies, or staining protocols for fluorescence microscopy.

  ### Data Collection
  - [Instruments](Instrument.md): The equipment used, from Titan Krios microscopes to synchrotron 
    beamlines. Each instrument type ([CryoEMInstrument](CryoEMInstrument.md), 
    [XRayInstrument](XRayInstrument.md), [SAXSInstrument](SAXSInstrument.md)) has specific parameters
    like accelerating voltage, detector type, or beam energy.

  - [Experiment Runs](ExperimentRun.md): Individual data collection sessions that link samples to 
    instruments. An experiment run captures when, how, and under what conditions data was collected,
    including quality metrics like resolution and completeness.

  ### Data Processing
  - [Workflow Runs](WorkflowRun.md): Computational processing steps applied to raw data. This includes
    motion correction for cryo-EM movies, 3D reconstruction, model building, or phase determination
    for crystallography. Each workflow tracks the software used, parameters, and computational resources.

  ### Data Products
  - [Data Files](DataFile.md): Any files generated or used, from raw data to final models. Each file
    is tracked with checksums for data integrity and typed (micrograph, particles, volume, model).

  - [Images](Image.md): Specialized classes for different imaging modalities:
    - [Image2D](Image2D.md): Micrographs, diffraction patterns
    - [Image3D](Image3D.md): 3D reconstructions, tomograms
    - [FTIRImage](FTIRImage.md): Molecular composition maps from infrared spectroscopy
    - [FluorescenceImage](FluorescenceImage.md): Fluorophore-labeled cellular components
    - [OpticalImage](OpticalImage.md): Brightfield/phase contrast microscopy
    - [XRFImage](XRFImage.md): Elemental distribution maps

  ## Example Usage

  A typical cryo-EM study of a protein complex would include:
  1. Sample records for the purified complex with molecular weight and buffer composition
  2. Grid preparation details with vitrification parameters
  3. Microscope specifications and data collection parameters
  4. Processing workflows from motion correction through 3D refinement
  5. Final reconstructed volumes and fitted atomic models

  A multimodal plant imaging study might combine:
  1. Whole plant optical imaging for morphology
  2. XRF imaging to map nutrient distribution
  3. FTIR spectroscopy to identify stress-related molecular changes
  4. Fluorescence microscopy to track specific protein responses
  5. Cryo-EM of isolated organelles for ultrastructural details

  ## Key Features

  - **Technique-agnostic core**: The same schema handles data from any structural biology method
  - **Rich metadata**: Comprehensive tracking from sample to structure
  - **Workflow provenance**: Complete computational reproducibility
  - **Multimodal support**: Seamlessly integrate data across scales and techniques
  - **Standards-compliant**: Follows FAIR principles and integrates with existing ontologies

prefixes:
  lambdaber: https://w3id.org/lambda-ber-schema/
  linkml: https://w3id.org/linkml/
  dcterms: http://purl.org/dc/terms/
  skos: http://www.w3.org/2004/02/skos/core#
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  prov: http://www.w3.org/ns/prov#
  sio: http://semanticscience.org/resource/
  nmdc: https://w3id.org/nmdc/
  NCBITaxon: http://purl.obolibrary.org/obo/NCBITaxon_
  UBERON: http://purl.obolibrary.org/obo/UBERON_
  CL: http://purl.obolibrary.org/obo/CL_

imports:
  - linkml:types
  - functional_annotation

default_range: string
default_prefix: lambdaber

types:


classes:

  NamedThing:
    description: "A named thing"
    abstract: true
    attributes:
      id:
        description: "Globally unique identifier as an IRI or CURIE for machine processing and external references. Used for linking data across systems and semantic web integration."
        identifier: true
        range: uriorcurie
      title:
        slot_uri: dcterms:title
      description:
        range: string

  AttributeGroup:
    description: "A grouping of related data attributes that form a logical unit"
    abstract: true
    attributes:
      description:
        range: string

  Dataset:
    is_a: NamedThing
    tree_root: true
    description: "A collection of studies"
    attributes:
      keywords:
        range: string
        multivalued: true
      instruments:
        range: Instrument
        multivalued: true
        inlined: true
        inlined_as_list: true
      studies:
        range: Study
        multivalued: true
        inlined: true
        inlined_as_list: true

  Study:
    is_a: NamedThing
    description: "A focused research investigation that groups related samples, experiments, and data collection around a specific biological question or hypothesis"
    attributes:
      protein_constructs:
        description: "Protein constructs and cloning information"
        range: ProteinConstruct
        multivalued: true
        inlined_as_list: true
      samples:
        range: Sample
        multivalued: true
        inlined_as_list: true
      sample_preparations:
        range: SamplePreparation
        multivalued: true
        inlined_as_list: true
      instrument_runs:
        range: ExperimentRun
        multivalued: true
        inlined_as_list: true
      workflow_runs:
        range: WorkflowRun
        multivalued: true
        inlined_as_list: true
      data_files:
        range: DataFile
        multivalued: true
        inlined_as_list: true
      images:
        range: Image
        multivalued: true
        inlined: true
        inlined_as_list: true
      aggregated_protein_views:
        description: "Aggregated functional and structural annotations for proteins in this study"
        range: AggregatedProteinView
        multivalued: true
        inlined_as_list: true

  Sample:
    is_a: NamedThing
    description: "A biological sample used in structural biology experiments"
    attributes:
      sample_code:
        description: "Human-friendly laboratory identifier or facility code for the sample (e.g., 'ALS-12.3.1-SAMPLE-001', 'LAB-PROT-2024-01'). Used for local reference and tracking within laboratory workflows."
        required: true
      sample_type:
        description: "Type of biological sample"
        range: SampleTypeEnum
        required: true
      molecular_composition:
        description: "Description of molecular composition including sequences, modifications, ligands"
        range: MolecularComposition
      molecular_weight:
        description: "Molecular weight in kDa"
        range: float
        unit:
          ucum_code: kDa
      concentration:
        description: "Sample concentration in mg/mL or µM"
        range: float
      concentration_unit:
        description: "Unit of concentration measurement"
        range: ConcentrationUnitEnum
      buffer_composition:
        description: "Buffer composition including pH, salts, additives"
        range: BufferComposition
      preparation_method:
        description: "Method used to prepare the sample"
      storage_conditions:
        description: "Storage conditions for the sample"
        range: StorageConditions
      organism:
        description: "Source organism for the sample (e.g., NCBITaxon:3702 for Arabidopsis thaliana)"
        range: OntologyTerm
      anatomy:
        description: "Anatomical part or tissue (e.g., UBERON:0008945 for leaf)"
        range: OntologyTerm
      cell_type:
        description: "Cell type if applicable (e.g., CL:0000057 for fibroblast)"
        range: OntologyTerm
      parent_sample_id:
        description: "Reference to parent sample for derivation tracking"
        range: Sample
      purity_percentage:
        description: "Sample purity as percentage"
        range: float
        minimum_value: 0
        maximum_value: 100
      quality_metrics:
        description: "Quality control metrics for the sample"
      # Functional annotations from knowledge bases
      functional_sites:
        description: "Functional site annotations for proteins in the sample"
        range: FunctionalSite
        multivalued: true
        inlined_as_list: true
      structural_features:
        description: "Structural feature annotations"
        range: StructuralFeature
        multivalued: true
        inlined_as_list: true
      protein_interactions:
        description: "Protein-protein interaction annotations"
        range: ProteinProteinInteraction
        multivalued: true
        inlined_as_list: true
      ligand_interactions:
        description: "Small molecule interaction annotations"
        range: LigandInteraction
        multivalued: true
        inlined_as_list: true
      mutation_effects:
        description: "Effects of mutations present in the sample"
        range: MutationEffect
        multivalued: true
        inlined_as_list: true
      ptm_annotations:
        description: "Post-translational modification annotations"
        range: PostTranslationalModification
        multivalued: true
        inlined_as_list: true
      biophysical_properties:
        description: "Measured or predicted biophysical properties"
        range: BiophysicalProperty
        multivalued: true
        inlined_as_list: true
      evolutionary_conservation:
        description: "Evolutionary conservation data"
        range: EvolutionaryConservation
        inlined: true
      conformational_ensemble:
        description: "Conformational states and dynamics"
        range: ConformationalEnsemble
        inlined: true
      database_cross_references:
        description: "Cross-references to external databases"
        range: DatabaseCrossReference
        multivalued: true
        inlined_as_list: true

  ProteinConstruct:
    is_a: NamedThing
    description: "Detailed information about a protein construct including cloning and sequence design"
    attributes:
      construct_id:
        description: "Unique identifier for this construct"
        required: true
      uniprot_id:
        description: "UniProt accession for the target protein"
      gene_name:
        description: "Gene name"
      ncbi_taxid:
        description: "NCBI Taxonomy ID for source organism"
      sequence_length_aa:
        description: "Length of the protein sequence in amino acids"
        range: integer
      construct_description:
        description: "Human-readable description of the construct"
      gene_synthesis_provider:
        description: "Company or facility that synthesized the gene"
      codon_optimization_organism:
        description: "Organism for which codons were optimized"
      vector_backbone:
        description: "Base plasmid backbone used"
      vector_name:
        description: "Complete vector name"
      promoter:
        description: "Promoter used for expression"
      tag_nterm:
        description: "N-terminal tag (e.g., His6, MBP, GST)"
      tag_cterm:
        description: "C-terminal tag"
      cleavage_site:
        description: "Protease cleavage site sequence"
      signal_peptide:
        description: "Signal peptide sequence if present"
      selectable_marker:
        description: "Antibiotic resistance or other selectable marker"
      cloning_method:
        description: "Method used for cloning (e.g., restriction digest, Gibson, InFusion)"
      insert_boundaries:
        description: "Start and end positions of insert in vector"
      sequence_file_path:
        description: "Path to sequence file"
      sequence_verified_by:
        description: "Method or person who verified the sequence"
      verification_notes:
        description: "Notes from sequence verification"

  SamplePreparation:
    is_a: NamedThing
    description: "A process that prepares a sample for imaging"
    attributes:
      preparation_type:
        description: "Type of sample preparation"
        range: PreparationTypeEnum
        required: true
      sample_id:
        description: "Reference to the sample being prepared"
        range: string
        required: true
      preparation_date:
        description: "Date of sample preparation"
        range: string
      operator_id:
        description: "Identifier or name of the person who performed the sample preparation (e.g., 'jsmith', 'John Smith', or personnel ID)"
        range: string
      protocol_description:
        description: "Detailed protocol description"
      # Expression parameters
      expression_system:
        description: "Expression system used for recombinant protein production"
        range: ExpressionSystemEnum
      host_strain_or_cell_line:
        description: "Specific strain or cell line used (e.g., BL21(DE3), Sf9, HEK293F)"
      culture_volume_l:
        description: "Culture volume in liters"
        range: float
      medium:
        description: "Growth medium used"
      antibiotic_selection:
        description: "Antibiotic or selection agent used"
      growth_temperature_c:
        description: "Growth temperature in Celsius"
        range: float
      induction_agent:
        description: "Agent used to induce expression (e.g., IPTG, tetracycline)"
      inducer_concentration:
        description: "Concentration of induction agent"
      induction_temperature_c:
        description: "Temperature during induction in Celsius"
        range: float
      induction_time_h:
        description: "Duration of induction in hours"
        range: float
      od600_at_induction:
        description: "Optical density at 600nm when induction was started"
        range: float
      harvest_timepoint:
        description: "Time point when cells were harvested"
      lysis_method:
        description: "Method used for cell lysis"
      protease_inhibitors:
        description: "Protease inhibitors added"
      # Purification parameters
      purification_steps:
        description: "Ordered list of purification steps performed"
        range: PurificationStepEnum
        multivalued: true
      affinity_type:
        description: "Type of affinity chromatography"
      affinity_column:
        description: "Affinity column specifications"
      lysis_buffer:
        description: "Buffer composition for lysis"
      wash_buffer:
        description: "Buffer composition for washing"
      elution_buffer:
        description: "Buffer composition for elution"
      tag_removal:
        description: "Whether and how affinity tag was removed"
        range: boolean
      protease:
        description: "Protease used for tag cleavage"
      protease_ratio:
        description: "Ratio of protease to protein"
      cleavage_time_h:
        description: "Duration of protease cleavage in hours"
        range: float
      cleavage_temperature_c:
        description: "Temperature during cleavage in Celsius"
        range: float
      second_affinity_reverse:
        description: "Second affinity or reverse affinity step"
      iex_column:
        description: "Ion-exchange column used"
      hic_column:
        description: "Hydrophobic interaction column used"
      sec_column:
        description: "Size-exclusion column used"
      sec_buffer:
        description: "Buffer for size-exclusion chromatography"
      concentration_method:
        description: "Method used to concentrate protein"
      final_buffer:
        description: "Final buffer composition after purification"
      final_concentration_mg_per_ml:
        description: "Final protein concentration in mg/mL"
        range: float
      yield_mg:
        description: "Total yield in milligrams"
        range: float
      purity_by_sds_page_percent:
        description: "Purity percentage by SDS-PAGE"
        range: float
      aggregation_assessment:
        description: "Assessment of protein aggregation state"
      aliquoting:
        description: "How the protein was aliquoted for storage"

  Instrument:
    is_a: NamedThing
    description: "An instrument used to collect data"
    attributes:
      instrument_code:
        description: "Human-friendly facility or laboratory identifier for the instrument (e.g., 'TITAN-KRIOS-1', 'ALS-12.3.1-SIBYLS', 'RIGAKU-FR-E'). Used for local reference and equipment tracking."
        required: true
      manufacturer:
        description: "Instrument manufacturer"
      model:
        description: "Instrument model"
      installation_date:
        description: "Date of instrument installation"
        range: string
      current_status:
        description: "Current operational status"
        range: InstrumentStatusEnum

  CryoEMInstrument:
    is_a: Instrument
    description: "Cryo-EM microscope specifications"
    attributes:
      accelerating_voltage:
        description: "Accelerating voltage in kV"
        range: integer
        any_of:
          - equals_number: 120
          - equals_number: 200
          - equals_number: 300
      cs_corrector:
        description: "Spherical aberration corrector present"
        range: boolean
      phase_plate:
        description: "Phase plate available"
        range: boolean
      detector_type:
        description: "Type of detector"
        range: DetectorTypeEnum
      detector_dimensions:
        description: "Detector dimensions in pixels (e.g., 4096x4096)"
      pixel_size_min:
        description: "Minimum pixel size in Angstroms per pixel"
        range: float
      pixel_size_max:
        description: "Maximum pixel size in Angstroms per pixel"
        range: float
      autoloader_capacity:
        description: "Number of grids the autoloader can hold"
        range: integer

  XRayInstrument:
    is_a: Instrument
    description: "X-ray diffractometer or synchrotron beamline specifications"
    attributes:
      source_type:
        description: "Type of X-ray source"
        range: XRaySourceTypeEnum
      energy_min:
        description: "Minimum X-ray energy in keV"
        range: float
      energy_max:
        description: "Maximum X-ray energy in keV"
        range: float
      beam_size_min:
        description: "Minimum beam size in micrometers"
        range: float
      beam_size_max:
        description: "Maximum beam size in micrometers"
        range: float
      flux_density:
        description: "Photon flux density in photons/s/mm²"
        range: float
      monochromator_type:
        description: "Type of monochromator"
      goniometer_type:
        description: "Type of goniometer"
      crystal_cooling_capability:
        description: "Crystal cooling system available"
        range: boolean

  SAXSInstrument:
    is_a: Instrument
    description: "SAXS/WAXS instrument specifications"
    attributes:
      q_range_min:
        description: "Minimum q value in inverse Angstroms"
        range: float
      q_range_max:
        description: "Maximum q value in inverse Angstroms"
        range: float
      detector_distance_min:
        description: "Minimum detector distance in mm"
        range: float
      detector_distance_max:
        description: "Maximum detector distance in mm"
        range: float
      sample_changer_capacity:
        description: "Number of samples in automatic sample changer"
        range: integer
      temperature_control_range:
        description: "Temperature control range in Celsius"

  ExperimentRun:
    is_a: NamedThing
    description: "An experimental data collection session"
    attributes:
      experiment_code:
        description: "Human-friendly laboratory or facility identifier for the experiment (e.g., 'SIBYLS-2024-02-01-hetBGL', 'CRYOEM-RUN-240815-001'). Used for local tracking and cross-referencing within laboratory systems."
        required: true
      sample_id:
        description: "Reference to the sample being analyzed"
        range: string
        required: true
      instrument_id:
        description: "Reference to the instrument used"
        range: Instrument
        required: true
      experiment_date:
        description: "Date of the experiment"
        range: string
      operator_id:
        description: "Identifier or name of the person who performed the experiment data collection (e.g., 'jsmith', 'John Smith', or personnel ID)"
        range: string
      technique:
        description: "Technique used for data collection"
        range: TechniqueEnum
        required: true
      experimental_method:
        description: "Specific experimental method for structure determination (particularly for diffraction techniques)"
        range: ExperimentalMethodEnum
      experimental_conditions:
        description: "Environmental and experimental conditions"
        range: ExperimentalConditions
      data_collection_strategy:
        description: "Strategy for data collection"
        range: DataCollectionStrategy
      quality_metrics:
        description: "Quality metrics for the experiment"
        range: QualityMetrics
      raw_data_location:
        description: "Location of raw data files"
      processing_status:
        description: "Current processing status"
        range: ProcessingStatusEnum

  WorkflowRun:
    is_a: NamedThing
    description: "A computational processing workflow execution"
    attributes:
      workflow_code:
        description: "Human-friendly identifier for the computational workflow run (e.g., 'MOTION-CORR-RUN-001', 'RELION-REFINE-240815'). Used for tracking processing pipelines and computational provenance."
        required: true
      workflow_type:
        description: "Type of processing workflow"
        range: WorkflowTypeEnum
        required: true
      experiment_id:
        description: "Reference to the source experiment"
        range: string
        required: true
      processing_level:
        description: "Processing level (0=raw, 1=corrected, 2=derived, 3=model)"
        range: integer
        minimum_value: 0
        maximum_value: 4
      software_name:
        description: "Software used for processing"
        required: true
      software_version:
        description: "Software version"
      additional_software:
        description: "Additional software used in pipeline"
      processing_parameters:
        description: "Parameters used in processing"
      parameters_file_path:
        description: "Path to parameters file or text of key parameters"
      # Crystallographic processing modules
      indexer_module:
        description: "Indexing module used (e.g., MOSFLM, XDS)"
      integrator_module:
        description: "Integration module used"
      scaler_module:
        description: "Scaling module used (e.g., AIMLESS, SCALA)"
      outlier_rejection_method:
        description: "Method for rejecting outlier reflections"
      # Phasing and refinement
      phasing_method:
        description: "Phasing method used for X-ray crystallography structure determination"
        range: PhasingMethodEnum
      search_model_pdb_id:
        description: "PDB ID of search model for molecular replacement"
      tls_used:
        description: "Whether TLS (Translation/Libration/Screw) refinement was used"
        range: boolean
      ncs_used:
        description: "Whether Non-Crystallographic Symmetry restraints were used"
        range: boolean
      restraints_other:
        description: "Other restraints applied during refinement"
      ligands_cofactors:
        description: "Ligands or cofactors modeled in the structure"
      number_of_waters:
        description: "Number of water molecules modeled"
        range: integer
      refinement_resolution_a:
        description: "Resolution cutoff used for refinement in Angstroms"
        range: float
      deposited_to_pdb:
        description: "Whether structure was deposited to PDB"
        range: boolean
      pdb_id:
        description: "PDB accession code if deposited"
      validation_report_path:
        description: "Path to validation report"
      # Processing notes and metadata
      processing_notes:
        description: "Additional notes about processing"
      compute_resources:
        description: "Computational resources used"
        range: ComputeResources
      started_at:
        description: "Workflow start time"
        range: string
      completed_at:
        description: "Workflow completion time"
        range: string
      output_files:
        description: "Output files generated"
        range: DataFile
        multivalued: true

  DataFile:
    is_a: NamedThing
    description: "A data file generated or used in the study"
    attributes:
      file_name:
        description: "Name of the file"
        required: true
      file_path:
        description: "Path to the file"
      file_format:
        description: "File format"
        range: FileFormatEnum
        required: true
      file_size_bytes:
        description: "File size in bytes"
        range: integer
      checksum:
        description: "SHA-256 checksum for data integrity"
      creation_date:
        description: "File creation date"
        range: string
      data_type:
        description: "Type of data in the file"
        range: DataTypeEnum

  Image:
    is_a: NamedThing
    description: "An image file from structural biology experiments"
    attributes:
      file_name:
        description: "Image file name"
        required: true
      acquisition_date:
        description: "Date image was acquired"
        range: string
      pixel_size:
        description: "Pixel size in Angstroms"
        range: float
      dimensions_x:
        description: "Image width in pixels"
        range: integer
      dimensions_y:
        description: "Image height in pixels"
        range: integer
      exposure_time:
        description: "Exposure time in seconds"
        range: float
      dose:
        description: "Electron dose in e-/Å²"
        range: float
      
  Image2D:
    is_a: Image
    description: "A 2D image (micrograph, diffraction pattern)"
    attributes:
      defocus:
        description: "Defocus value in micrometers"
        range: float
      astigmatism:
        description: "Astigmatism value"
        range: float

  Image3D:
    is_a: Image
    description: "A 3D volume or tomogram"
    attributes:
      dimensions_z:
        description: "Image depth in pixels/slices"
        range: integer
      voxel_size:
        description: "Voxel size in Angstroms"
        range: float
      reconstruction_method:
        description: "Method used for 3D reconstruction"

  FTIRImage:
    is_a: Image
    description: "Fourier Transform Infrared (FTIR) spectroscopy image capturing molecular composition through vibrational spectroscopy"
    attributes:
      wavenumber_min:
        description: "Minimum wavenumber in cm⁻¹"
        range: float
      wavenumber_max:
        description: "Maximum wavenumber in cm⁻¹"
        range: float
      spectral_resolution:
        description: "Spectral resolution in cm⁻¹"
        range: float
      number_of_scans:
        description: "Number of scans averaged for the spectrum"
        range: integer
      apodization_function:
        description: "Mathematical function used for apodization"
        range: string
      molecular_signatures:
        description: "Identified molecular signatures or peaks"
        range: string
        multivalued: true
      background_correction:
        description: "Method used for background correction"
        range: string

  FluorescenceImage:
    is_a: Image2D
    description: "Fluorescence microscopy image capturing specific molecular targets through fluorescent labeling"
    attributes:
      excitation_wavelength:
        description: "Excitation wavelength in nanometers"
        range: float
      emission_wavelength:
        description: "Emission wavelength in nanometers"
        range: float
      excitation_filter:
        description: "Specifications of the excitation filter"
        range: string
      emission_filter:
        description: "Specifications of the emission filter"
        range: string
      fluorophore:
        description: "Name or type of fluorophore used"
        range: string
      channel_name:
        description: "Name of the fluorescence channel (e.g., DAPI, GFP, RFP)"
        range: string
      laser_power:
        description: "Laser power in milliwatts or percentage"
        range: float
      pinhole_size:
        description: "Pinhole size in Airy units for confocal microscopy"
        range: float
      quantum_yield:
        description: "Quantum yield of the fluorophore"
        range: float

  OpticalImage:
    is_a: Image2D
    description: "Visible light optical microscopy or photography image"
    attributes:
      illumination_type:
        description: "Type of illumination (brightfield, darkfield, phase contrast, DIC)"
        range: IlluminationTypeEnum
      magnification:
        description: "Optical magnification factor"
        range: float
      numerical_aperture:
        description: "Numerical aperture of the objective lens"
        range: float
      color_channels:
        description: "Color channels present (e.g., RGB, grayscale)"
        range: string
        multivalued: true
      white_balance:
        description: "White balance settings"
        range: string
      contrast_method:
        description: "Contrast enhancement method used"
        range: string

  XRFImage:
    is_a: Image2D
    description: "X-ray fluorescence (XRF) image showing elemental distribution"
    attributes:
      beam_energy:
        description: "X-ray beam energy in keV"
        range: float
      beam_size:
        description: "X-ray beam size in micrometers"
        range: float
      dwell_time:
        description: "Dwell time per pixel in milliseconds"
        range: float
      elements_measured:
        description: "Elements detected and measured"
        range: string
        multivalued: true
      source_type:
        description: "X-ray source type (synchrotron or lab-source)"
        range: XRaySourceTypeEnum
      detector_type:
        description: "Type of X-ray detector used"
        range: string
      flux:
        description: "Photon flux in photons/second"
        range: float
      calibration_standard:
        description: "Reference standard used for calibration"
        range: string

  ImageFeature:
    is_a: AttributeGroup
    description: "Semantic annotations describing features identified in images using controlled vocabulary terms"
    attributes:
      terms:
        range: OntologyTerm

  OntologyTerm:
    is_a: NamedThing
    attributes:
      label:
        range: string
      definition:
        range: string
      ontology:
        range: string

  MolecularComposition:
    is_a: AttributeGroup
    description: "Molecular composition of a sample"
    attributes:
      sequences:
        description: "Amino acid or nucleotide sequences"
        range: string
        multivalued: true
      modifications:
        description: "Post-translational modifications or chemical modifications"
        range: string
        multivalued: true
      ligands:
        description: "Bound ligands or cofactors"
        range: string
        multivalued: true

  BufferComposition:
    is_a: AttributeGroup
    description: "Buffer composition for sample storage"
    attributes:
      ph:
        description: "pH of the buffer"
        range: float
        minimum_value: 0
        maximum_value: 14
      components:
        description: "Buffer components and their concentrations"
        range: string
        multivalued: true
      additives:
        description: "Additional additives in the buffer"
        range: string
        multivalued: true

  StorageConditions:
    is_a: AttributeGroup
    description: "Storage conditions for samples"
    attributes:
      temperature:
        description: "Storage temperature in Celsius"
        range: float
      temperature_unit:
        description: "Temperature unit"
        range: TemperatureUnitEnum
      duration:
        description: "Storage duration"
        range: string
      atmosphere:
        description: "Storage atmosphere conditions"
        range: string

  TechniqueSpecificPreparation:
    is_a: AttributeGroup
    description: "Base class for technique-specific preparation details"
    abstract: true

  CryoEMPreparation:
    is_a: TechniqueSpecificPreparation
    description: "Cryo-EM specific sample preparation"
    attributes:
      grid_type:
        description: "Type of EM grid used"
        range: GridTypeEnum
      support_film:
        description: "Support film type"
        range: string
      hole_size:
        description: "Hole size in micrometers"
        range: float
        minimum_value: 0.5
        maximum_value: 5.0
      vitrification_method:
        description: "Method used for vitrification"
        range: VitrificationMethodEnum
      blot_time:
        description: "Blotting time in seconds"
        range: float
        minimum_value: 0.5
        maximum_value: 10.0
      blot_force:
        description: "Blotting force setting"
        range: integer
      humidity_percentage:
        description: "Chamber humidity during vitrification"
        range: float
        minimum_value: 0
        maximum_value: 100
      chamber_temperature:
        description: "Chamber temperature in Celsius"
        range: float
      plasma_treatment:
        description: "Plasma treatment details"

  XRayPreparation:
    is_a: TechniqueSpecificPreparation
    description: "X-ray crystallography specific preparation"
    attributes:
      # Pre-crystallization
      protein_concentration_mg_per_ml:
        description: "Protein concentration for crystallization in mg/mL"
        range: float
      protein_buffer:
        description: "Buffer composition for protein solution"
      additives:
        description: "Additives mixed with protein before crystallization"
      # Crystallization setup
      crystallization_method:
        description: "Method used for crystallization"
        range: CrystallizationMethodEnum
      screen_name:
        description: "Name of crystallization screen used"
      temperature_c:
        description: "Crystallization temperature in Celsius"
        range: float
      drop_ratio_protein_to_reservoir:
        description: "Ratio of protein to reservoir solution in drop (e.g., 1:1, 2:1)"
      drop_volume_nl:
        description: "Total drop volume in nanoliters"
        range: float
      reservoir_volume_ul:
        description: "Reservoir volume in microliters"
        range: float
      seeding_type:
        description: "Type of seeding used (micro, macro, streak)"
      seed_stock_dilution:
        description: "Dilution factor for seed stock"
      # Optimization
      initial_hit_condition:
        description: "Description of initial crystallization hit condition"
      optimization_strategy:
        description: "Strategy used to optimize crystals"
      optimized_condition:
        description: "Final optimized crystallization condition"
      crystallization_conditions:
        description: "Detailed crystallization conditions"
      # Crystal handling
      crystal_size_um:
        description: "Crystal dimensions in micrometers"
      cryoprotectant:
        description: "Cryoprotectant used"
        range: string
      cryoprotectant_concentration:
        description: "Cryoprotectant concentration percentage"
        range: float
      soak_compound:
        description: "Compound used for soaking (ligand, heavy atom)"
      soak_conditions:
        description: "Conditions for crystal soaking"
      mounting_method:
        description: "Crystal mounting method"
      flash_cooling_method:
        description: "Flash cooling protocol"
      crystal_notes:
        description: "Additional notes about crystal quality and handling"

  SAXSPreparation:
    is_a: TechniqueSpecificPreparation
    description: "SAXS/WAXS specific preparation"
    attributes:
      concentration_series:
        description: "Concentration values for series measurements"
        range: float
        multivalued: true
      buffer_matching_protocol:
        description: "Protocol for buffer matching"
      sample_cell_type:
        description: "Type of sample cell used"
      cell_path_length:
        description: "Path length in mm"
        range: float
      temperature_control:
        description: "Temperature control settings"

  ExperimentalConditions:
    is_a: AttributeGroup
    description: "Environmental and experimental conditions"
    attributes:
      temperature:
        description: "Temperature in Celsius"
        range: float
      humidity:
        description: "Humidity percentage"
        range: float
      pressure:
        description: "Pressure in kPa"
        range: float
      atmosphere:
        description: "Atmosphere composition"
      beam_energy:
        description: "Beam energy in keV"
        range: float
      exposure_time:
        description: "Exposure time in seconds"
        range: float

  DataCollectionStrategy:
    is_a: AttributeGroup
    description: "Strategy for data collection"
    attributes:
      collection_mode:
        description: "Mode of data collection"
        range: CollectionModeEnum
      total_frames:
        description: "Total number of frames/images"
        range: integer
      frame_rate:
        description: "Frames per second"
        range: float
      total_dose:
        description: "Total electron dose for cryo-EM"
        range: float
      dose_per_frame:
        description: "Dose per frame"
        range: float
      # X-ray specific parameters
      wavelength_a:
        description: "X-ray wavelength in Angstroms"
        range: float
      detector:
        description: "Detector model/type"
      detector_distance_mm:
        description: "Detector distance in millimeters"
        range: float
      beam_center_x_px:
        description: "Beam center X coordinate in pixels"
        range: integer
      beam_center_y_px:
        description: "Beam center Y coordinate in pixels"
        range: integer
      beam_size_um:
        description: "Beam size in micrometers"
        range: float
      flux_photons_per_s:
        description: "Photon flux in photons per second"
        range: float
      transmission_percent:
        description: "Beam transmission percentage"
        range: float
      attenuator:
        description: "Attenuator setting used"
      temperature_k:
        description: "Data collection temperature in Kelvin"
        range: float
      oscillation_per_image_deg:
        description: "Oscillation angle per image in degrees"
        range: float
      total_rotation_deg:
        description: "Total rotation range in degrees"
        range: float
      strategy_notes:
        description: "Notes about data collection strategy"

  QualityMetrics:
    is_a: AttributeGroup
    description: "Quality metrics for experiments"
    attributes:
      # General metrics
      resolution:
        description: "Resolution in Angstroms"
        range: float
      resolution_high_shell_a:
        description: "High resolution shell limit in Angstroms"
        range: float
      resolution_low_a:
        description: "Low resolution limit in Angstroms"
        range: float
      completeness:
        description: "Data completeness percentage"
        range: float
      completeness_high_res_shell_percent:
        description: "Completeness in highest resolution shell"
        range: float
      signal_to_noise:
        description: "Signal to noise ratio"
        range: float
      mean_i_over_sigma_i:
        description: "Mean I/sigma(I)"
        range: float
      # Crystallographic processing metrics
      space_group:
        description: "Crystallographic space group"
      unit_cell_a:
        description: "Unit cell parameter a in Angstroms"
        range: float
      unit_cell_b:
        description: "Unit cell parameter b in Angstroms"
        range: float
      unit_cell_c:
        description: "Unit cell parameter c in Angstroms"
        range: float
      unit_cell_alpha:
        description: "Unit cell angle alpha in degrees"
        range: float
      unit_cell_beta:
        description: "Unit cell angle beta in degrees"
        range: float
      unit_cell_gamma:
        description: "Unit cell angle gamma in degrees"
        range: float
      multiplicity:
        description: "Data multiplicity (redundancy)"
        range: float
      cc_half:
        description: "Half-set correlation coefficient CC(1/2)"
        range: float
      r_merge:
        description: "Rmerge - merge R-factor"
        range: float
      r_pim:
        description: "Rpim - precision-indicating merging R-factor"
        range: float
      wilson_b_factor_a2:
        description: "Wilson B-factor in Angstroms squared"
        range: float
      anomalous_used:
        description: "Whether anomalous signal was used"
        range: boolean
      anom_corr:
        description: "Anomalous correlation"
        range: float
      anom_sig_ano:
        description: "Anomalous signal strength"
        range: float
      # Refinement metrics
      r_work:
        description: "Refinement R-factor (working set)"
        range: float
      r_free:
        description: "R-free (test set)"
        range: float
      ramachandran_favored_percent:
        description: "Percentage of residues in favored Ramachandran regions"
        range: float
      ramachandran_outliers_percent:
        description: "Percentage of Ramachandran outliers"
        range: float
      clashscore:
        description: "MolProbity clashscore"
        range: float
      molprobity_score:
        description: "Overall MolProbity score"
        range: float
      average_b_factor_a2:
        description: "Average B-factor in Angstroms squared"
        range: float
      # SAXS metrics
      i_zero:
        description: "Forward scattering intensity I(0)"
        range: float
      rg:
        description: "Radius of gyration in Angstroms"
        range: float
      # Legacy/deprecated
      r_factor:
        description: "R-factor for crystallography (deprecated, use r_work)"
        range: float

  ComputeResources:
    is_a: AttributeGroup
    description: "Computational resources used"
    attributes:
      cpu_hours:
        description: "CPU hours used"
        range: float
      gpu_hours:
        description: "GPU hours used"
        range: float
      memory_gb:
        description: "Maximum memory used in GB"
        range: float
      storage_gb:
        description: "Storage used in GB"
        range: float

enums:
  SampleTypeEnum:
    description: "Types of biological samples"
    permissible_values:
      protein:
        description: "Protein sample"
      nucleic_acid:
        description: "Nucleic acid sample (DNA or RNA)"
      complex:
        description: "Protein-protein or protein-nucleic acid complex"
      membrane_protein:
        description: "Membrane protein sample"
      virus:
        description: "Viral particle"
      organelle:
        description: "Cellular organelle"

  ConcentrationUnitEnum:
    description: "Units for concentration measurement"
    permissible_values:
      mg_per_ml:
        description: "Milligrams per milliliter"
      micromolar:
        description: "Micromolar"
      millimolar:
        description: "Millimolar"
      nanomolar:
        description: "Nanomolar"

  TemperatureUnitEnum:
    description: "Units for temperature measurement"
    permissible_values:
      celsius:
        description: "Degrees Celsius"
      kelvin:
        description: "Kelvin"
      fahrenheit:
        description: "Degrees Fahrenheit"

  PreparationTypeEnum:
    description: "Types of sample preparation"
    permissible_values:
      cryo_em:
        description: "Cryo-EM preparation"
      xray_crystallography:
        description: "X-ray crystallography preparation"
      saxs:
        description: "SAXS/WAXS preparation"
      sans:
        description: "SANS preparation"
      protein_expression:
        description: "Protein expression in host cells"
      protein_purification:
        description: "Protein purification"
      negative_stain:
        description: "Negative stain EM preparation"

  GridTypeEnum:
    description: "Types of EM grids"
    permissible_values:
      c_flat:
        description: "C-flat holey carbon grid"
      quantifoil:
        description: "Quantifoil holey carbon grid"
      lacey_carbon:
        description: "Lacey carbon grid"
      ultrathin_carbon:
        description: "Ultrathin carbon film"
      gold:
        description: "Gold grid"

  VitrificationMethodEnum:
    description: "Methods for vitrification"
    permissible_values:
      plunge_freezing:
        description: "Plunge freezing in liquid ethane"
      high_pressure_freezing:
        description: "High pressure freezing"
      slam_freezing:
        description: "Slam freezing"

  CrystallizationMethodEnum:
    description: "Methods for protein crystallization"
    permissible_values:
      vapor_diffusion_hanging:
        description: "Vapor diffusion hanging drop"
      vapor_diffusion_sitting:
        description: "Vapor diffusion sitting drop"
      batch:
        description: "Batch crystallization"
      microbatch:
        description: "Microbatch under oil"
      lcp:
        description: "Lipidic cubic phase (LCP)"
      dialysis:
        description: "Dialysis method"
      free_interface_diffusion:
        description: "Free interface diffusion"

  InstrumentStatusEnum:
    description: "Operational status of instruments"
    permissible_values:
      operational:
        description: "Instrument is operational"
      maintenance:
        description: "Instrument under maintenance"
      offline:
        description: "Instrument is offline"
      commissioning:
        description: "Instrument being commissioned"

  DetectorTypeEnum:
    description: "Types of detectors for cryo-EM"
    permissible_values:
      direct_electron:
        description: "Direct electron detector"
      ccd:
        description: "CCD camera"
      cmos:
        description: "CMOS detector"
      hybrid_pixel:
        description: "Hybrid pixel detector"

  XRaySourceTypeEnum:
    description: "Types of X-ray sources"
    permissible_values:
      synchrotron:
        description: "Synchrotron radiation source"
      rotating_anode:
        description: "Rotating anode generator"
      microfocus:
        description: "Microfocus sealed tube"
      metal_jet:
        description: "Liquid metal jet source"

  TechniqueEnum:
    description: "Structural biology techniques"
    permissible_values:
      cryo_em:
        description: "Cryo-electron microscopy"
      xray_crystallography:
        description: "X-ray crystallography"
      saxs:
        description: "Small-angle X-ray scattering"
      waxs:
        description: "Wide-angle X-ray scattering"
      sans:
        description: "Small-angle neutron scattering"
      cryo_et:
        description: "Cryo-electron tomography"
      electron_microscopy:
        description: "General electron microscopy"
      mass_spectrometry:
        description: "Mass spectrometry"

  ProcessingStatusEnum:
    description: "Processing status"
    permissible_values:
      raw:
        description: "Raw data"
      preprocessing:
        description: "Being preprocessed"
      processing:
        description: "Being processed"
      completed:
        description: "Processing completed"
      failed:
        description: "Processing failed"

  WorkflowTypeEnum:
    description: "Types of processing workflows"
    permissible_values:
      motion_correction:
        description: "Motion correction for cryo-EM"
      ctf_estimation:
        description: "CTF estimation"
      particle_picking:
        description: "Particle picking"
      classification_2d:
        description: "2D classification"
      classification_3d:
        description: "3D classification"
      refinement:
        description: "3D refinement"
      model_building:
        description: "Atomic model building"
      phasing:
        description: "Phase determination"
      integration:
        description: "Data integration"
      scaling:
        description: "Data scaling"
      saxs_analysis:
        description: "SAXS data analysis"
      em_2d_classification:
        description: "EM 2D classification"
      mass_spec_deconvolution:
        description: "Mass spectrometry deconvolution"

  FileFormatEnum:
    description: "File formats"
    permissible_values:
      mrc:
        description: "MRC format for EM data"
      tiff:
        description: "TIFF image format"
      hdf5:
        description: "HDF5 hierarchical data format"
      star:
        description: "STAR format for metadata"
      pdb:
        description: "PDB coordinate format"
      mmcif:
        description: "mmCIF format"
      mtz:
        description: "MTZ reflection format"
      cbf:
        description: "Crystallographic Binary Format"
      ascii:
        description: "ASCII text format"
      thermo_raw:
        description: "Thermo Fisher RAW format"
      zip:
        description: "ZIP compressed archive"

  DataTypeEnum:
    description: "Types of data"
    permissible_values:
      micrograph:
        description: "Electron micrograph"
      diffraction:
        description: "Diffraction pattern"
      scattering:
        description: "Scattering data"
      particles:
        description: "Particle stack"
      volume:
        description: "3D volume"
      model:
        description: "Atomic model"
      metadata:
        description: "Metadata file"
      raw_data:
        description: "Raw experimental data"
      processed_data:
        description: "Processed data"

  CollectionModeEnum:
    description: "Data collection modes"
    permissible_values:
      counting:
        description: "Counting mode"
      super_resolution:
        description: "Super-resolution mode"
      continuous:
        description: "Continuous collection"
      oscillation:
        description: "Oscillation method"
      still:
        description: "Still images"
      batch:
        description: "Batch mode collection"
      sec_saxs:
        description: "SEC-SAXS collection mode"
      single_particle:
        description: "Single particle analysis mode"

  IlluminationTypeEnum:
    description: "Types of illumination for optical microscopy"
    permissible_values:
      brightfield:
        description: "Brightfield illumination"
      darkfield:
        description: "Darkfield illumination"
      phase_contrast:
        description: "Phase contrast microscopy"
      dic:
        description: "Differential interference contrast (DIC/Nomarski)"
      fluorescence:
        description: "Fluorescence illumination"
      confocal:
        description: "Confocal laser scanning"
      polarized:
        description: "Polarized light microscopy"
      oblique:
        description: "Oblique illumination"

  ExpressionSystemEnum:
    description: "Expression systems for recombinant protein production"
    permissible_values:
      bacteria:
        description: "Bacterial expression (e.g., E. coli)"
      yeast:
        description: "Yeast expression (e.g., S. cerevisiae, P. pastoris)"
      insect:
        description: "Insect cell expression (e.g., Sf9, High Five)"
      mammalian:
        description: "Mammalian cell expression (e.g., HEK293, CHO)"
      cell_free:
        description: "Cell-free expression system"

  PurificationStepEnum:
    description: "Protein purification steps and methods"
    permissible_values:
      affinity_ni_nta:
        description: "Affinity chromatography using Ni-NTA resin"
      affinity_co_nta:
        description: "Affinity chromatography using Co-NTA resin"
      affinity_strep:
        description: "Affinity chromatography using Strep-tag"
      affinity_mbp:
        description: "Affinity chromatography using maltose-binding protein (MBP)"
      affinity_gst:
        description: "Affinity chromatography using glutathione S-transferase (GST)"
      tag_cleavage:
        description: "Proteolytic cleavage of purification tags"
      ion_exchange:
        description: "Ion-exchange chromatography (IEX)"
      hydrophobic_interaction:
        description: "Hydrophobic interaction chromatography (HIC)"
      size_exclusion:
        description: "Size-exclusion chromatography (SEC)"
      dialysis:
        description: "Dialysis or buffer exchange"

  PhasingMethodEnum:
    description: "Methods for phase determination in X-ray crystallography"
    permissible_values:
      molecular_replacement:
        description: "Molecular replacement (MR)"
      sad:
        description: "Single-wavelength anomalous diffraction (SAD)"
      mad:
        description: "Multi-wavelength anomalous diffraction (MAD)"
      sir:
        description: "Single isomorphous replacement (SIR)"
      mir:
        description: "Multiple isomorphous replacement (MIR)"
      siras:
        description: "Single isomorphous replacement with anomalous scattering (SIRAS)"
      miras:
        description: "Multiple isomorphous replacement with anomalous scattering (MIRAS)"
      fragile_mr:
        description: "Fragile molecular replacement or ensemble-based MR"

  ExperimentalMethodEnum:
    description: "Experimental methods for structure determination"
    permissible_values:
      x_ray_diffraction:
        description: "X-ray diffraction"
      neutron_diffraction:
        description: "Neutron diffraction"
      electron_diffraction:
        description: "Electron diffraction (e.g., microED)"
      fiber_diffraction:
        description: "Fiber diffraction"
